---
title: "CLRNet: Cross Layer Refinement Network for Lane Detection"
date: "2022-12-15 12:00:00"
identifier: LineNet
category: "Lane Detection"
hero: /assets/images/posts/CLRNet/img1.png
link: https://github.com/Turoad/CLRNet
tags: ["Lane Detection"]
conference: CVPR
year: 2022
math: true
layout: post
---

# æ¦‚è¦

- ç‰¹å¾´æŠ½å‡ºã—ãŸFPNæ§‹é€ ã®ç‰¹å¾´ãƒãƒƒãƒ—ã‚’ã€ä¸Šä½ã‹ã‚‰ä¸‹ä½ã¾ã§è¤‡åˆçš„ã«æ´»ç”¨ã™ã‚‹è»Šç·šæ¤œå‡ºæ‰‹æ³•ã§ã‚ã‚‹Cross Layer Refinement Network (CLRNet)ã‚’ææ¡ˆ
- CULaneã¨TuSimpleã¨LLAMASã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§å¾“æ¥æ‰‹æ³•ã‚’ä¸Šå›ã‚‹
<!--more-->

# æ–°è¦æ€§ãƒ»å·®åˆ†

- è»Šç·šã®éƒ¨åˆ†é ˜åŸŸã¨å…¨ä½“ã‚’çµ„ã¿åˆã‚ã›ã¦å¤§åŸŸçš„ãªç‰¹å¾´è¡¨ç¾ã‚’ç²å¾—ã™ã‚‹ROIGatherã‚’ä½¿ç”¨
- è»Šç·šã®æ¤œå‡ºçµæœã«å¯¾ã™ã‚‹IoUã¨ã—ã¦LIoU(Line IoU)ã‚’å®šç¾©ã—ã€LIoUã®æœ€å¤§åŒ–ã‚’æå¤±é–¢æ•°ã«å«ã‚“ã 

# ã‚¢ã‚¤ãƒ‡ã‚¢

- ![](/assets/images/posts/CLRNet/img1.png)
- äºŒæ¬¡å…ƒã®ç‚¹åˆ—$ğ‘ƒ$ï¼ˆãƒ¬ãƒ¼ãƒ³äº‹å‰åˆ†å¸ƒï¼‰ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§å‡ºåŠ›
    - å‰æ™¯ã¨èƒŒæ™¯ã®ç¢ºç‡ã€ç·šã®é•·ã•ã€è§’åº¦ã€äºˆæ¸¬ã¨æ­£è§£ã®æ°´å¹³è·é›¢
- ResNetã‚’Backboneã¨ã—ã€FPNæ§‹é€ ã‹ã‚‰ç‰¹å¾´ãƒãƒƒãƒ—$ğ¿_0, ğ¿_1, ğ¿_2$ã‚’ç”Ÿæˆ
- ç‚¹åˆ—$P$ã¨ç‰¹å¾´ãƒãƒƒãƒ—$L$ã‚’çµ„ã¿åˆã‚ã›ã‚‹
    - $$ P_t = P_{t-1} \circ R_t (L_{t-1},P_{t-1}) $$
    - ä¸Šä½ã‹ã‚‰ä¸‹ä½ã®ç‰¹å¾´ã‚’æ´»ç”¨ã™ã‚‹ãŸã‚
- ç‚¹åˆ—Pã‚’ã‚‚ã¨ã«ç‰¹å¾´ãƒãƒƒãƒ—$L$ã‚’ROIAlignã§æŠ½å‡º
- Attentionã‚’ã¨ã‚‹
    - $$ \mathcal{G} = \mathcal{W}\mathcal{X}^T_f $$
    - $$ \mathcal{W} = f(\frac{\mathcal{X}^T_p \mathcal{X}_f}{\sqrt{C}}) $$
- Line IoU Loss
    - ç‚¹ã‚’åˆ¥ã€…ã®å¤‰æ•°ã¨ã—ã¦æ‰±ã†ãŸã‚ã€æ—¢å­˜ã®è·é›¢æå¤±ã‚’ç”¨ã„ã‚‹ã¨ç²¾åº¦ãŒä½ããªã£ã¦ã—ã¾ã†
    - ãã“ã§ã€è»Šç·šå°‚ç”¨ã®Lossã‚’ææ¡ˆ
        - $$ IoU = \frac{d^\omicron_i}{d^u_i} = \frac{\min(x^p_i+e, x^q_i+e) - \max(x^p_i+e, x^q_i+e)}{\max(x^p_i-e, x^q_i-e) - \min(x^p_i-e, x^q_i-e)} $$
        - $$ LIoU = \frac{\sum^N_{i=1} d^\omicron_i}{\sum^N_{i=1} d^u_i} $$

# çµæœ

- CULane
    - ![](/assets/images/posts/CLRNet/img7.png)
    
- LLAMAS
    - ![](/assets/images/posts/CLRNet/img8.png)
    
- TuSimple
    - ![](/assets/images/posts/CLRNet/img9.png)
    - ![](/assets/images/posts/CLRNet/img10.png)